name: apu_timer
bus: ahbl
addr: 16
data: 32
params:
  W_CTR: 20
  N_TIMERS: 3
regs:
  - generate: |
      _(f'- name: csr')
      _(f'  bits:')
      _(f'  - {{b: [{N_TIMERS-1},0], name: en, access: rw}}')
      _(f'  - {{b: [{N_TIMERS-1+8},8], name: reload, access: rw}}')
      _(f'  - {{b: [{N_TIMERS-1+16},16], name: irq, access: w1c, info: Interrupt status -- write one to clear each bit}}')
      _(f'- name: tick')
      _(f'  bits:')
      _(f'  - {{b: [7, 0], rst: 23, access: rw, info: All counters decrement once every TICK + 1 cycles.}}')
      for i in range(N_TIMERS):
          _(f'- name: reload{i}')
          _(f'  bits:')
          _(f'  - {{b: [{W_CTR-1}, 0], access: rw}}')
          _(f'  info: Reload value for counter {i}. The counter takes this value on the next tick after reaching zero, if bit {i} of CSR_EN and CSR_RELOAD are both set.')
          _(f'- name: ctr{i}')
          _(f'  bits:')
          _(f'  - {{b: [{W_CTR-1}, 0], access: rwv}}')
          _(f'  info: Counter {i}. Can be read and written by software. Counts down when bit {i} of CSR_EN is set. Raises IRQ {i} upon decrementing to 0.')
